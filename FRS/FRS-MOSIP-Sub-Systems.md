## Table Of Content
- [Sub-Systems](#sub-systems)
  * [1. UIN Generation](#1-uin-generation) (MOS_PFM_SUB_FR_1)
  * [2. Configuration Server](#2-configuration-server) (MOS_PFM_SUB_FR_2)
  * [3. Audit Manager](#3-audit-manager) (MOS_PFM_SUB_FR_3)
    * [3.1 Log Manager](#31-log-manager)
  * [4. LDAP / Authorization](#4-ldap--authorization-wip) (MOS_PFM_SUB_FR_4)
# Sub-Systems
## 1. UIN Generation
MOSIP generates a pool of UINs before the registration process and stores them. 
The number of UINs to be generated in a pool depends on a configuration to be done by the country depending on the peak registration requirements. UIN generation service will receive a request by Registration Processor to get a UIN. The service responds with an un-allocated UIN from the generated Pool. 
When the pool reaches a configured number of minimum UINs, MOSIP generates another pool of UIN. 


The UINs generated follow the following policies:


1. UIN should not contain any alphanumeric characters
1. UIN should not contain any repeating numbers for 2 or more than 2 digits
1. UIN should not contain any sequential number for 3 or more than 3 digits
1. UIN should not be generated sequentially
1. UIN should not have repeated block of numbers for 2 or more than 2 digits
1. The last digit in the number should be reserved for a checksum
1. The number should not contain '0' or '1' as the first digit.
1. First 5 digits should be different from the last 5 digits (E.g. 4345643456)
1. First 5 digits should be different to the last 5 digits reversed (E.g. 4345665434)
1. UIN should not be an ascending or descending cyclic figure (E.g. 4567890123, 6543210987)
1. UIN should be different from the repetition of the first two digits 5 times (E.g. 3434343434)
1. UIN should not contain three even adjacent digits (E.g. 3948613752)
1. UIN should not contain ADMIN defined restricted number

## 2. Configuration Server

MOSIP has a centralized config server where all the configuration elements are saved, including the platform config and ID Object schema.
The Central config server provides following functionality:
1. It provides functionality to read XML files and Property files
1. It helps to manage all the configuration files stored at a centralized location in Git
1. It provides a functionality to change the property for a micro-service, it can reflect the changes dynamically without redeploying the micro-service.
1. This component allows all the configurations to come from a central server

[Please refer the **configuring MOSIP** section in **Getting Started guide** for more details on the configuration server](Getting-Started#7-configuring-mosip-)

## 3. Audit Manager
The Audit Manager component receives a request to audit and store data, validates if the request is from an authorized source, securely store the requested data and respond back with an acknowledgement of storage (Success/Failure). This component will also ensure non-auditable data is not stored.
Upon receiving a request to store audit logs with the input parameters the audit manager performs the following steps:
1. Validates if all required input parameters have been received as listed below for each specific request

   * Audit Event ID - Mandatory
   * Audit Event name - Mandatory
   * Audit Event Type - Mandatory
   * Action DateTimestamp - Mandatory
   * Host - Name - Mandatory
   * Host - IP - Mandatory
   * Application Id - Mandatory
   * Application Name - Mandatory
   * Session User Id - Mandatory
   * Session User Name - Mandatory
   * Module Name â€“ Optional
   * Module Id - Optional
   * ID - Mandatory
   * ID Type - Mandatory
   * Logged Timestamp - Mandatory
   * Audit Log Description - Optional
   * cr_by, (Actor who has done the event) - Mandatory
   * cr_dtimes, (When this row is inserted into Database) - Mandatory

2. Validates if the Audit Request is not for one of the exempted events as listed in the Exempted Audit Event List/Table
1. Time Stamp (format: yyyy-MM-ddThh:mm:ss) and Unique Audit ID are generated by the Audit manager component for each Audit REQuest
1. All the input parameters received are stored in the audit Database
1. PII data as listed below is not stored
   * Name
   * DOB
   * Contact Number
   * Citizenship
   * Legal Status
   * Gender
   * Race/Ethnicity
   * Any Government Identification Number
6. Responds with the acknowledgment to source
   * Success
   * Failure
7. Raises an alert in case of an exception 

### 3.1 Log Manager
Log manager provides following functionalities:

1. Generate logs across the application
1. Store generated logs in configured location
1. Support for reading the logger configurations through as external file
1. Support addition log level to a particular logger dynamically

## 4. LDAP / Authorization (WIP)
MOSIP system can handle Authorization across core services and restricts access to Web-services as per the roles defined below:

1. OTP manager: To be defined
1. SMS Notification Manager API : To be defined
1. Email Notification Manager API : To be defined
1. Software Updater API - Master Data : To be defined
1. Software Updater API - Configurations : To be defined
1. Software Updater API - Public Keys : To be defined
1. Crypto Service API : To be defined
1. Key Manager API : To be defined
1. Master Data APIs (All Create/Update/Delete) : To be defined
1. UIN Generator : To be defined
1. Audit Manager : To be defined
1. OTP Notification Service : To be defined
1. ID Repo Service : To be defined
